<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>MBK Chat</title>
<script src="https://unpkg.com/@supabase/supabase-js"></script>
<style>
  body { background:black; color:#3CA832; font-family:Arial; padding:20px; }
  #messages { height:70vh; overflow-y:auto; border:1px solid #3CA832; padding:10px; }
  input, button { margin-top:10px; padding:8px; background:#111; color:#3CA832; border:1px solid #3CA832; }
</style>
</head>
<body>
<h2>ðŸ’¬ MBK Chat Room</h2>
<div id="messages"></div>
<input id="msgInput" placeholder="Type your message..." />
<button onclick="sendMessage()">Send</button>

<script>
  const { createClient } = supabase;
  const supabaseUrl = 'YOUR_SUPABASE_URL';
  const supabaseKey = 'YOUR_SUPABASE_ANON_KEY';
  const client = createClient(supabaseUrl, supabaseKey);

  async function loadMessages() {
    const { data } = await client.from('messages').select('*').order('created_at', { ascending: true });
    const list = document.getElementById('messages');
    list.innerHTML = data.map(m => `<p><b>${m.user_email || 'Anon'}:</b> ${m.content}</p>`).join('');
  }

  async function sendMessage() {
    const content = document.getElementById('msgInput').value;
    if(!content) return;
    await client.from('messages').insert({ content });
    document.getElementById('msgInput').value = '';
    loadMessages();
  }

  loadMessages();
  client.channel('chat').on('postgres_changes', { event: '*', schema: 'public', table: 'messages' }, loadMessages).subscribe();
</script>
</body>
</html>
